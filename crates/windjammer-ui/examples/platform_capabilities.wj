// Platform Capabilities Example
// Demonstrates filesystem, GPS, camera, clipboard, and notifications

use windjammer_ui.platform.capability_impl.{
    Filesystem, GPS, Camera, Clipboard, Notifications,
    Location, Notification, CameraImage
}

fn demo_filesystem() {
    print("ğŸ“ Filesystem API Demo")
    print("=" * 40)
    
    let fs = Filesystem.new()
    
    // Request permission
    fs.request_permission("/tmp").unwrap()
    print("âœ… Permission granted for /tmp")
    
    // Write file
    let path = "/tmp/windjammer_test.txt"
    fs.write_text(path, "Hello from Windjammer UI!").unwrap()
    print("âœ… Wrote file: {path}")
    
    // Read file
    let content = fs.read_text(path).unwrap()
    print("âœ… Read file: \"{content}\"")
    
    // Check existence
    print("âœ… File exists: {}", fs.exists(path))
    
    // List directory
    let files = fs.list_dir("/tmp").unwrap()
    print("âœ… Files in /tmp: {} files", files.len())
    
    // Clean up
    print("")
}

fn demo_gps() {
    print("ğŸ“ GPS/Location API Demo")
    print("=" * 40)
    
    let gps = GPS.new()
    
    // Enable GPS
    gps.enable().unwrap()
    print("âœ… GPS enabled")
    
    // Set location (simulated)
    let location = Location {
        latitude: 37.7749,
        longitude: -122.4194,
        altitude: Some(10.0),
        accuracy: 5.0,
        timestamp: 1234567890
    }
    gps.set_location(location)
    print("âœ… Location set (simulated)")
    
    // Get location
    let current = gps.get_location().unwrap()
    print("âœ… Current location:")
    print("   Latitude: {current.latitude}")
    print("   Longitude: {current.longitude}")
    print("   Altitude: {current.altitude:?}")
    print("   Accuracy: Â±{current.accuracy}m")
    print("")
}

fn demo_camera() {
    print("ğŸ“· Camera API Demo")
    print("=" * 40)
    
    let camera = Camera.new()
    
    // Request permission
    camera.request_permission().unwrap()
    print("âœ… Camera permission granted")
    
    // Capture image
    let image = camera.capture().unwrap()
    print("âœ… Image captured:")
    print("   Size: {}x{}", image.width, image.height)
    print("   Format: {image.format:?}")
    print("   Data size: {} bytes", image.data.len())
    
    // Capture another
    camera.capture().unwrap()
    print("âœ… Second image captured")
    
    let images = camera.get_captured_images()
    print("âœ… Total images: {images.len()}")
    print("")
}

fn demo_clipboard() {
    print("ğŸ“‹ Clipboard API Demo")
    print("=" * 40)
    
    let clipboard = Clipboard.new()
    
    // Write to clipboard
    clipboard.write_text("Windjammer UI is awesome!").unwrap()
    print("âœ… Wrote to clipboard")
    
    // Read from clipboard
    let content = clipboard.read_text().unwrap()
    print("âœ… Read from clipboard: \"{content}\"")
    
    // Check if has content
    print("âœ… Has content: {clipboard.has_content()}")
    print("")
}

fn demo_notifications() {
    print("ğŸ”” Notifications API Demo")
    print("=" * 40)
    
    let notifications = Notifications.new()
    
    // Request permission
    notifications.request_permission().unwrap()
    print("âœ… Notification permission granted")
    
    // Send notifications
    notifications.send(Notification {
        title: "Welcome!".to_string(),
        body: "Windjammer UI is running".to_string(),
        icon: Some("icon.png".to_string())
    }).unwrap()
    print("âœ… Notification sent: Welcome")
    
    notifications.send(Notification {
        title: "New Message".to_string(),
        body: "You have 3 unread messages".to_string(),
        icon: None
    }).unwrap()
    print("âœ… Notification sent: New Message")
    
    let sent = notifications.get_sent()
    print("âœ… Total notifications sent: {sent.len()}")
    print("")
}

fn main() {
    print("=== Platform Capabilities Example ===\n")
    
    demo_filesystem()
    demo_gps()
    demo_camera()
    demo_clipboard()
    demo_notifications()
    
    print("ğŸ¯ Key Features:")
    print("  âœ… Permission-based security model")
    print("  âœ… Cross-platform API (Web, Desktop, Mobile)")
    print("  âœ… Filesystem access with path restrictions")
    print("  âœ… GPS/Location services")
    print("  âœ… Camera capture")
    print("  âœ… Clipboard read/write")
    print("  âœ… Native notifications")
    
    print("\nğŸ”’ Security:")
    print("  â€¢ All capabilities require explicit permission")
    print("  â€¢ Filesystem access is path-restricted")
    print("  â€¢ Follows principle of least privilege")
    print("  â€¢ Permission denials are graceful")
    
    print("\nğŸŒ Platform Support:")
    print("  â€¢ Web: Uses Web APIs (File API, Geolocation API, etc)")
    print("  â€¢ Desktop: Native file access, system notifications")
    print("  â€¢ Mobile: Native APIs (iOS/Android)")
}

