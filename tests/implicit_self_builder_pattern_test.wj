// Test: Compiler should add implicit self parameter for builder pattern methods
//
// Builder pattern WITHOUT explicit self parameter:
// - Method uses self.field
// - Method returns self (or Self type)
// - Compiler MUST add "mut self" parameter automatically
//
// This is how windjammer-ui code is written - it omits self and expects compiler to add it

pub struct Config {
    pub name: String,
    pub timeout: i32,
}

impl Config {
    pub fn new() -> Config {
        Config {
            name: String::new(),
            timeout: 30,
        }
    }

    // Builder pattern WITHOUT explicit self
    // Should generate: pub fn name(mut self, name: String) -> Config
    pub fn name(name: String) -> Config {
        self.name = name
        self
    }

    // Builder pattern WITHOUT explicit self
    // Should generate: pub fn timeout(mut self, timeout: i32) -> Config
    pub fn timeout(timeout: i32) -> Config {
        self.timeout = timeout
        self
    }
}

pub struct Avatar {
    pub src: String,
    pub alt: String,
}

impl Avatar {
    pub fn new(src: String) -> Avatar {
        Avatar {
            src,
            alt: "Avatar".to_string(),
        }
    }

    // Builder pattern WITHOUT explicit self - matches windjammer-ui pattern
    pub fn alt(alt: String) -> Avatar {
        self.alt = alt
        self
    }

    // Non-builder method - reads field, returns different type
    // Should generate: pub fn get_src(&self) -> String
    pub fn get_src() -> String {
        self.src.clone()
    }
}

pub fn main() {
    // Builder pattern chaining
    let config = Config::new()
        .name("MyApp".to_string())
        .timeout(60);

    println!("Config: {} (timeout: {})", config.name, config.timeout);

    // Avatar builder
    let avatar = Avatar::new("photo.jpg".to_string())
        .alt("Profile".to_string());

    println!("Avatar: {} (alt: {})", avatar.src, avatar.alt);
}

